---
layout: default
---
{% include exp-header.html %}
  <article class="post">
    {% include exp-list.html %}
<h1 id="ğŸ’¡ ìƒí‘œ ë„í˜• ì½”ë“œ ì¶”ì²œ ëª¨ë¸  ì—°êµ¬ ë° API ê°œë°œ">ğŸ’¡ìƒí‘œ ë„í˜• ì½”ë“œ ì¶”ì²œ ëª¨ë¸ ì—°êµ¬ ë° API ê°œë°œ</h1>
<p class="meta"><small>ğŸ“… 2022.12 ~ 2023.03</small></p><hr/>
  <ul>
    <h3>ğŸ“š ì‚¬ìš© ìŠ¤íƒ</h3>
    <img src="https://img.shields.io/badge/Python-3776AB.svg?&style=for-the-badge&logo=Python&logoColor=white"/>
    <img src="https://img.shields.io/badge/PyTorch-EE4C2C.svg?&style=for-the-badge&logo=PyTorch&logoColor=white"/>
    <img src="https://img.shields.io/badge/Pandas-150458.svg?&style=for-the-badge&logo=Pandas&logoColor=white"/>
    <img src="https://img.shields.io/badge/OpenCV-5C3EE8.svg?&style=for-the-badge&logo=OpenCV&logoColor=white"/>
    <img src="https://img.shields.io/badge/Docker-2496ED.svg?&style=for-the-badge&logo=Docker&logoColor=white"/>
    <img src="https://img.shields.io/badge/fastapi-009688.svg?&style=for-the-badge&logo=fastapi&logoColor=white"/>
    <img src="https://img.shields.io/badge/mongodb-47A248.svg?&style=for-the-badge&logo=MongoDB&logoColor=white"/>
    <br><br>

    <h3>ğŸ’» ê°œë°œ í™˜ê²½</h3>
      <img src="https://img.shields.io/badge/Ubuntu-E95420.svg?&style=for-the-badge&logo=ubuntu&logoColor=white"/>
    <br><br>

    <h3>ğŸ‘¥ íŒ€í”„ë¡œì íŠ¸ </h3>
    <small><b>AI ì—”ì§€ë‹ˆì–´ 1</b>, ë°±ì—”ë“œ ì—”ì§€ë‹ˆì–´ 1, í”„ë¡ íŠ¸ì—”ë“œ ì—”ì§€ë‹ˆì–´ 1</small>
    <br><br>
      <ol>
        <li> ë§ˆí¬ë·° ì„±ëŠ¥ ê°œì„  ë° annotation toolì˜ ë„í˜• ì½”ë“œ ì¶”ì²œì„ ìœ„í•œ AI ëª¨ë¸ ê°œë°œ</li>
        <li> pymongoë¥¼ ì´ìš©í•œ ë°ì´í„° ì¶”ì¶œ</li>
        <li> í•™ìŠµ ë°ì´í„°(ìƒí‘œ ë°ì´í„°) ë¶„ì„ ë° ëª¨ë¸ í•™ìŠµ</li>
        <li> ë¯¸êµ­ê³¼ í•œêµ­ì˜ ë¹„ì—”ë‚˜ì½”ë“œ ë§¤ì¹­ ë“± ë°ì´í„° ì „ì²˜ë¦¬</li>
        <li> ëª¨ë¸ í•™ìŠµ ë° íŠœë‹</li>
      </ol>
    <br>
    <h3></h3>
      <ol>
        <li>ë°ì´í„° ì •ì œ</li>
        <ul>
        <li>ìƒí‘œ ì´ë¯¸ì§€ 300ë§Œê°œ ì´ìƒ, 1700ì—¬ê°œì˜ ì„¸ë¶„ë¥˜, ê·¹ë‹¨ì ìœ¼ë¡œ ë¶ˆê· í˜•í•œ ë°ì´í„°. 20ì—¬ê°œì˜ ì¤‘ë¶„ë¥˜ê°€ ë°ì´í„°ì˜ 80%ì´ìƒì„ ì°¨ì§€</li>
        <li>ë„í˜•ë³µí•©ìƒí‘œ(ë¬¸ìì™€ ë„í˜•ì´ ëª¨ë‘ ìˆëŠ” ìƒí‘œ)ì—ì„œ ë„í˜•ì½”ë“œë¥¼ ì˜ˆì¸¡í•˜ê²Œ í•˜ê¸° ìœ„í•´ ë¬¸ììƒí‘œ, ë„í˜•ìƒí‘œ ê·¸ë¦¬ê³  ë„í˜•ë³µí•©ì˜ 99%ë¥¼ train ë°ì´í„°ë¡œ, ë„í˜•ë³µí•©ì˜ 1%ëŠ” valid/testë¡œ split</li>
        </ul>
        <li>ëª¨ë¸ ì„ íƒ ë° í•™ìŠµ</li>
        <ul>
          <li>SOTAì¸ EfficientNet ì„ íƒí•˜ì—¬ ì‹¤í—˜: EfficientNetB0 ~ B5 í•™ìŠµê²°ê³¼ B3ê°€ ê°€ì¥ ì„±ëŠ¥ì´ ë†’ì•„ì„œ ìµœì¢… ì„ íƒ</li>
          <li>ìƒí‘œì´ë¯¸ì§€ íŠ¹ì„± ìƒ ì—¬ë°±ê³¼ ë‹¨ìˆœí•œ ë„í˜•ì˜ ë‚˜ì—´ì´ ë§ì•„ ì‚¬ì „í•™ìŠµëœ ë°ì´í„°ì™€ mean, stdê°€ í¬ê²Œ ë‹¤ë¥¼ ê²ƒì´ë¼ ìƒê°í•˜ì—¬ í•™ìŠµë°ì´í„°ì˜ mean, stdë¥¼ êµ¬í•´ ì •ê·œí™”í•¨</li>
          <li>horizental filp, Color Inversion, ChannelShuffle, JpegCompression ë“±ì˜ Argumentation ìˆ˜í–‰</li>
          <div class="colorscripter-code" style="color:#f0f0f0;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">train_transform&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;A.Compose([</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.HorizontalFlip(p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.ChannelShuffle(always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">2</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.JpegCompression(always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1.</span><span style="color:#c10aff">0</span>,&nbsp;quality_lower<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">30</span>,&nbsp;quality_upper<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">100</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.Resize(args.imgsz,&nbsp;args.imgsz),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.Normalize(mean<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>NORM_PARAM[args.img_proc][<span style="color:#ffd500">'MEAN'</span>],&nbsp;std<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>NORM_PARAM[args.img_proc][<span style="color:#ffd500">'STD'</span>],&nbsp;max_pixel_value<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">255.</span><span style="color:#c10aff">0</span>,&nbsp;always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1.</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ToTensorV2()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
          <li>ë¶ˆê· í˜•í•œ 1700ì—¬ê°œì˜ ì„¸ë¶„ë¥˜ í´ë˜ìŠ¤ë¥¼ ë™ì‹œì— í•™ìŠµí•˜ëŠ” ê²ƒì€ ë„ˆë¬´ ë„ì „ì ì¸ ì¼ì´ë¼ íŒë‹¨í•˜ì—¬, 28ê°œì˜ ëŒ€ë¶„ë¥˜ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ê³¼ ê° ëŒ€ë¶„ë¥˜ì— í•´ë‹¹í•˜ëŠ” ì„¸ë¶„ë¥˜ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡í•˜ëŠ” 28ê°œì˜ ëª¨ë¸ì„ ë§Œë“¤ê¸°ë¡œ í•¨</li>
        </ul>
      </ol>
    <br><br>

    <h3>ğŸ‰ ê²°ê³¼ ë° ì„±ê³¼</h3>
    <img src="/assets/img/experience/mk_preview4.PNG"><br></center>
      <ul>
        <li>accuracy: í‰ê·  0.94, mAP: 0.54</li>
        <li>ë¼ë²¨ë§ ì‘ì—…ì ì†ë„ 70% ì´ìƒ í–¥ìƒ(ë™ì¼ ê¸°ê°„ ì‘ì—…ëŸ‰ ê¸°ì¤€)</li>
        <li>ë§ˆí¬ë·°ì˜ ì´ë¯¸ì§€ ê²€ìƒ‰ ê²°ê³¼ ê°œì„ </li>
          <ul>
            <li>ê¸°ì¡´ : ë¬¸ìì™€ ìœ ì‚¬í•´ ë³´ì´ëŠ” ë„í˜•ìƒí‘œì™€ ë¬¸ììƒí‘œê°€ í˜¼ì¬ë˜ì–´ ê²°ê³¼ì— ë‚˜íƒ€ë‚¨</li>
            <li>ì ìš©í›„ : ëª¨ë¸ì—ì„œ ê²€ì¶œëœ ë¹„ì—”ë‚˜ ì½”ë“œì— í•´ë‹¹í•˜ëŠ” ìƒí‘œê°€ ìš°ì„ ì ìœ¼ë¡œ ë‚˜íƒ€ë‚¨</li>
          </ul>
        <li>NVIDIA Triton Serverë¥¼ ì´ìš©í•œ ëª¨ë¸ ì„œë¹™ìœ¼ë¡œ ì¶”ë¡  ì†ë„ ì•½ 70% í–¥ìƒ (ìµœëŒ€ 0.2 ì´ˆ â†’ 0.06 ì´ˆ)<br><br>
          <ul>
            <li>Triton Inference Code</li>
            mlc_00: ëŒ€ë¶„ë¥˜ 28ê°œì˜ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ëª¨ë¸<br>
            mlc_01 ~ mlc_28: ê° ë²ˆí˜¸ì˜ ëŒ€ë¶„ë¥˜ì— í•´ë‹¹í•˜ëŠ” ì„¸ë¶„ë¥˜ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ëª¨ë¸ (ex. mlc_01: ëŒ€ë¶„ë¥˜ 01ì˜ ì„¸ë¶„ë¥˜ í´ë˜ìŠ¤ë¥¼ ì˜ˆì¸¡)<br>
            <div class="colorscripter-code" style="color:#f0f0f0;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:ë‚˜ëˆ”ê³ ë”•ì½”ë”© !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">class</span>&nbsp;TritonModel:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">def</span>&nbsp;__init__(<span style="color:#4be6fa">self</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;grpcclient.InferenceServerClient(url<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>f<span style="color:#ffd500">"{os.environ.get('TRITON_SERVER')}:{os.environ.get('GRPC_PORT')}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.inname&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"input"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.outname&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"output"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.threshold&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;options.threshold&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.labels&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;labels</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;@elapsed_time(<span style="color:#ffd500">'Time&nbsp;used&nbsp;to&nbsp;suggestion&nbsp;of&nbsp;vcode:&nbsp;'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">def</span>&nbsp;inference(<span style="color:#4be6fa">self</span>,&nbsp;image):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.prepare_img(image)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[grpcclient.InferInput(<span style="color:#4be6fa">self</span>.inname,&nbsp;image.shape,&nbsp;<span style="color:#ffd500">"FP32"</span>)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_data[<span style="color:#c10aff">0</span>].set_data_from_numpy(image)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[grpcclient.InferRequestedOutput(<span style="color:#4be6fa">self</span>.outname)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client.infer(<span style="color:#ffd500">"mlc_00"</span>,&nbsp;input_data,&nbsp;outputs<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>output_data)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;response.as_numpy(<span style="color:#4be6fa">self</span>.outname)[<span style="color:#c10aff">0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#4be6fa">str</span>(i).zfill(<span style="color:#c10aff">2</span>):v&nbsp;<span style="color:#ff3399">for</span>&nbsp;i,&nbsp;v&nbsp;<span style="color:#ff3399">in</span>&nbsp;enumerate(results,&nbsp;start<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>)&nbsp;<span style="color:#ff3399">if</span>&nbsp;v&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#4be6fa">self</span>.threshold}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;vcode,&nbsp;w&nbsp;<span style="color:#ff3399">in</span>&nbsp;results.items():</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client.infer(f<span style="color:#ffd500">"mlc_{vcode}"</span>,&nbsp;input_data,&nbsp;outputs<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>output_data)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;response.as_numpy(<span style="color:#4be6fa">self</span>.outname)[<span style="color:#c10aff">0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;i,&nbsp;p&nbsp;<span style="color:#ff3399">in</span>&nbsp;enumerate(out):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;p&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;w&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.threshold:&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vienna&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.labels[vcode][i]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;<span style="color:#4be6fa">self</span>.check_vienna(vienna):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[vienna]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;p&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;w</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#4be6fa">str</span>(k):float(v)&nbsp;<span style="color:#ff3399">for</span>&nbsp;k,v&nbsp;<span style="color:#ff3399">in</span>&nbsp;sorted(res.items(),&nbsp;key<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>lambda&nbsp;x:&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>x[<span style="color:#c10aff">1</span>])}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;res</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
          </ul>
        <br>
      </ul>
    </ul>
