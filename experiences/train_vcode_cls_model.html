---
layout: default
---
{% include exp-header.html %}
  <article class="post">
    {% include exp-list.html %}
<h1 id="💡 상표 도형 코드 추천 모델  연구 및 API 개발">💡상표 도형 코드 추천 모델 연구 및 API 개발</h1>
<p class="meta"><small>📅 2022.12 ~ 2023.03</small></p><hr/>
  <ul>
    <h3>📚 사용 스택</h3>
    <img src="https://img.shields.io/badge/Python-3776AB.svg?&style=for-the-badge&logo=Python&logoColor=white"/>
    <img src="https://img.shields.io/badge/PyTorch-EE4C2C.svg?&style=for-the-badge&logo=PyTorch&logoColor=white"/>
    <img src="https://img.shields.io/badge/Pandas-150458.svg?&style=for-the-badge&logo=Pandas&logoColor=white"/>
    <img src="https://img.shields.io/badge/OpenCV-5C3EE8.svg?&style=for-the-badge&logo=OpenCV&logoColor=white"/>
    <img src="https://img.shields.io/badge/Docker-2496ED.svg?&style=for-the-badge&logo=Docker&logoColor=white"/>
    <img src="https://img.shields.io/badge/fastapi-009688.svg?&style=for-the-badge&logo=fastapi&logoColor=white"/>
    <img src="https://img.shields.io/badge/mongodb-47A248.svg?&style=for-the-badge&logo=MongoDB&logoColor=white"/>
    <br><br>

    <h3>💻 개발 환경</h3>
      <img src="https://img.shields.io/badge/Ubuntu-E95420.svg?&style=for-the-badge&logo=ubuntu&logoColor=white"/>
    <br><br>

    <h3>👥 팀프로젝트 </h3>
    <small><b>AI 엔지니어 1</b>, 백엔드 엔지니어 1, 프론트엔드 엔지니어 1</small>
    <br><br>
      <ol>
        <li> 마크뷰 성능 개선 및 annotation tool의 도형 코드 추천을 위한 AI 모델 개발</li>
        <li> pymongo를 이용한 데이터 추출</li>
        <li> 학습 데이터(상표 데이터) 분석 및 모델 학습</li>
        <li> 미국과 한국의 비엔나코드 매칭 등 데이터 전처리</li>
        <li> 모델 학습 및 튜닝</li>
      </ol>
    <br>
    <h3></h3>
      <ol>
        <li>데이터 정제</li>
        <ul>
        <li>상표 이미지 300만개 이상, 1700여개의 세분류, 극단적으로 불균형한 데이터. 20여개의 중분류가 데이터의 80%이상을 차지</li>
        <li>도형복합상표(문자와 도형이 모두 있는 상표)에서 도형코드를 예측하게 하기 위해 문자상표, 도형상표 그리고 도형복합의 99%를 train 데이터로, 도형복합의 1%는 valid/test로 split</li>
        </ul>
        <li>모델 선택 및 학습</li>
        <ul>
          <li>SOTA인 EfficientNet 선택하여 실험: EfficientNetB0 ~ B5 학습결과 B3가 가장 성능이 높아서 최종 선택</li>
          <li>상표이미지 특성 상 여백과 단순한 도형의 나열이 많아 사전학습된 데이터와 mean, std가 크게 다를 것이라 생각하여 학습데이터의 mean, std를 구해 정규화함</li>
          <li>horizental filp, Color Inversion, ChannelShuffle, JpegCompression 등의 Argumentation 수행</li>
          <div class="colorscripter-code" style="color:#f0f0f0;font-family:나눔고딕코딩 !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:나눔고딕코딩 !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:나눔고딕코딩 !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">train_transform&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;A.Compose([</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.HorizontalFlip(p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">5</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.ChannelShuffle(always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">0.</span><span style="color:#c10aff">2</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.JpegCompression(always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1.</span><span style="color:#c10aff">0</span>,&nbsp;quality_lower<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">30</span>,&nbsp;quality_upper<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">100</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.Resize(args.imgsz,&nbsp;args.imgsz),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A.Normalize(mean<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>NORM_PARAM[args.img_proc][<span style="color:#ffd500">'MEAN'</span>],&nbsp;std<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>NORM_PARAM[args.img_proc][<span style="color:#ffd500">'STD'</span>],&nbsp;max_pixel_value<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">255.</span><span style="color:#c10aff">0</span>,&nbsp;always_apply<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">False</span>,&nbsp;p<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1.</span>),</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ToTensorV2()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
          <li>불균형한 1700여개의 세분류 클래스를 동시에 학습하는 것은 너무 도전적인 일이라 판단하여, 28개의 대분류 클래스를 예측하는 모델과 각 대분류에 해당하는 세분류 클래스를 예측하는 28개의 모델을 만들기로 함</li>
        </ul>
      </ol>
    <br><br>

    <h3>🎉 결과 및 성과</h3>
    <img src="/assets/img/experience/mk_preview4.PNG"><br></center>
      <ul>
        <li>accuracy: 평균 0.94, mAP: 0.54</li>
        <li>라벨링 작업자 속도 70% 이상 향상(동일 기간 작업량 기준)</li>
        <li>마크뷰의 이미지 검색 결과 개선</li>
          <ul>
            <li>기존 : 문자와 유사해 보이는 도형상표와 문자상표가 혼재되어 결과에 나타남</li>
            <li>적용후 : 모델에서 검출된 비엔나 코드에 해당하는 상표가 우선적으로 나타남</li>
          </ul>
        <li>NVIDIA Triton Server를 이용한 모델 서빙으로 추론 속도 약 70% 향상 (최대 0.2 초 → 0.06 초)<br><br>
          <ul>
            <li>Triton Inference Code</li>
            mlc_00: 대분류 28개의 클래스를 분류하는 모델<br>
            mlc_01 ~ mlc_28: 각 번호의 대분류에 해당하는 세분류 클래스를 분류하는 모델 (ex. mlc_01: 대분류 01의 세분류 클래스를 예측)<br>
            <div class="colorscripter-code" style="color:#f0f0f0;font-family:나눔고딕코딩 !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:나눔고딕코딩 !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:나눔고딕코딩 !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">class</span>&nbsp;TritonModel:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">def</span>&nbsp;__init__(<span style="color:#4be6fa">self</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;grpcclient.InferenceServerClient(url<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>f<span style="color:#ffd500">"{os.environ.get('TRITON_SERVER')}:{os.environ.get('GRPC_PORT')}"</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.inname&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"input"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.outname&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#ffd500">"output"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.threshold&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;options.threshold&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.labels&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;labels</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;@elapsed_time(<span style="color:#ffd500">'Time&nbsp;used&nbsp;to&nbsp;suggestion&nbsp;of&nbsp;vcode:&nbsp;'</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">def</span>&nbsp;inference(<span style="color:#4be6fa">self</span>,&nbsp;image):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.prepare_img(image)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[grpcclient.InferInput(<span style="color:#4be6fa">self</span>.inname,&nbsp;image.shape,&nbsp;<span style="color:#ffd500">"FP32"</span>)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input_data[<span style="color:#c10aff">0</span>].set_data_from_numpy(image)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_data&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[grpcclient.InferRequestedOutput(<span style="color:#4be6fa">self</span>.outname)]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client.infer(<span style="color:#ffd500">"mlc_00"</span>,&nbsp;input_data,&nbsp;outputs<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>output_data)&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;response.as_numpy(<span style="color:#4be6fa">self</span>.outname)[<span style="color:#c10aff">0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#4be6fa">str</span>(i).zfill(<span style="color:#c10aff">2</span>):v&nbsp;<span style="color:#ff3399">for</span>&nbsp;i,&nbsp;v&nbsp;<span style="color:#ff3399">in</span>&nbsp;enumerate(results,&nbsp;start<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#c10aff">1</span>)&nbsp;<span style="color:#ff3399">if</span>&nbsp;v&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span>&nbsp;<span style="color:#4be6fa">self</span>.threshold}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;vcode,&nbsp;w&nbsp;<span style="color:#ff3399">in</span>&nbsp;results.items():</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;&nbsp;<span style="color:#4be6fa">self</span>.client.infer(f<span style="color:#ffd500">"mlc_{vcode}"</span>,&nbsp;input_data,&nbsp;outputs<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>output_data)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;response.as_numpy(<span style="color:#4be6fa">self</span>.outname)[<span style="color:#c10aff">0</span>]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;i,&nbsp;p&nbsp;<span style="color:#ff3399">in</span>&nbsp;enumerate(out):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;p&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;w&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">&gt;</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.threshold:&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vienna&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#4be6fa">self</span>.labels[vcode][i]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;<span style="color:#4be6fa">self</span>.check_vienna(vienna):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res[vienna]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;p&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">*</span>&nbsp;w</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{<span style="color:#4be6fa">str</span>(k):float(v)&nbsp;<span style="color:#ff3399">for</span>&nbsp;k,v&nbsp;<span style="color:#ff3399">in</span>&nbsp;sorted(res.items(),&nbsp;key<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>lambda&nbsp;x:&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">-</span>x[<span style="color:#c10aff">1</span>])}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">return</span>&nbsp;res</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#4f4f4ftext-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
          </ul>
        <br>
      </ul>
    </ul>
