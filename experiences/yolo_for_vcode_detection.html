---
layout: default
---
{% include exp-header.html %}
  <article class="post">
    {% include exp-list.html %}
<h1 id="2️⃣ 도형코드 중분류 검출 YOLO 모델 개발">2️⃣ 도형코드 중분류 검출 YOLO 모델 개발</h1>
<p class="meta"><small>📅 2022.09 ~ 2022.12</small></p><hr/>
  <ul>
    <h3>📚 사용 스택</h3>
    <table>
      <tr>
        <td><img src="https://img.shields.io/badge/Python-3776AB.svg?&style=for-the-badge&logo=Python&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/PyTorch-EE4C2C.svg?&style=for-the-badge&logo=PyTorch&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/Pandas-150458.svg?&style=for-the-badge&logo=Pandas&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/OpenCV-5C3EE8.svg?&style=for-the-badge&logo=OpenCV&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/Docker-2496ED.svg?&style=for-the-badge&logo=Docker&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/mongodb-47A248.svg?&style=for-the-badge&logo=MongoDB&logoColor=white"/></td>
        <td><img src="https://img.shields.io/badge/Jupyter-F37626.svg?&style=for-the-badge&logo=Jupyter&logoColor=white"/></td>
      </tr>
    </table>
    <br><br>

    <h3>💻 개발 환경</h3>
      <img src="https://img.shields.io/badge/Ubuntu-E95420.svg?&style=for-the-badge&logo=ubuntu&logoColor=white"/>
    <br><br>

    <h3>👥 개인 프로젝트 </h3>
    <small><b>AI 엔지니어 1</b></small>
    <br><br>
      <ol>
        <li> 2022 인공지능 학습용 데이터 개발 정부사업의 일환으로 상표 이미지 도형 코드 검출 모델 개발</li>
        <li> 3가지 사업(사용자 데이터, 간판 데이터, 해외 상표 데이터)의 데이터 분석, 모델 학습 및 검증</li>
      </ol>
    <br><br>
    데이터 분포 (간판 데이터)<br>
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:나눔고딕코딩 !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:나눔고딕코딩 !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:나눔고딕코딩 !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">train_df[<span style="color:#ffd500">'mid_vienna_code'</span>].value_counts().plot(kind<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#ffd500">'bar'</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">display(train_df[<span style="color:#ffd500">'mid_vienna_code'</span>].value_counts())</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
    <img src="/assets/img/experience/dataplot1.png"><br></center><br><br>

    이미지 다운로드 코드 일부<br>
    간판 데이터의 경우 휴대전화의 exif tag 까지 읽어서 회전 정보까지 저장해야 함
    <div class="colorscripter-code" style="color:#f0f0f0;font-family:나눔고딕코딩 !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#272727;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #4f4f4f"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#aaa;font-family:나눔고딕코딩 !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#f0f0f0;font-family:나눔고딕코딩 !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">image_error_id_lst&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;[]</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#ff3399">for</span>&nbsp;i&nbsp;<span style="color:#ff3399">in</span>&nbsp;tqdm(<span style="color:#4be6fa">range</span>(<span style="color:#4be6fa">len</span>(tmp_df))):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;tmp_df.iloc[i]</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;base_url&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">+</span>&nbsp;row.url_path</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;requests.get(url)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">try</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;Image.<span style="color:#4be6fa">open</span>(BytesIO(response.content))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exif&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PIL.ExifTags.TAGS[k]:&nbsp;v</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">for</span>&nbsp;k,&nbsp;v&nbsp;<span style="color:#ff3399">in</span>&nbsp;img._getexif().items()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;k&nbsp;<span style="color:#ff3399">in</span>&nbsp;PIL.ExifTags.TAGS</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">try</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">if</span>&nbsp;exif[<span style="color:#ffd500">'Orientation'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">3</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;img.rotate(<span style="color:#c10aff">180</span>,&nbsp;expand<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">True</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">elif</span>&nbsp;exif[<span style="color:#ffd500">'Orientation'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">6</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;img.rotate(<span style="color:#c10aff">270</span>,&nbsp;expand<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">True</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">elif</span>&nbsp;exif[<span style="color:#ffd500">'Orientation'</span>]&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;<span style="color:#c10aff">8</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;<span style="color:#0086b3"></span><span style="color:#ff3399">=</span>&nbsp;img.rotate(<span style="color:#c10aff">90</span>,&nbsp;expand<span style="color:#0086b3"></span><span style="color:#ff3399">=</span><span style="color:#4be6fa">True</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">except</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"no&nbsp;exif&nbsp;image&nbsp;:&nbsp;{row.img_name}")</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">pass</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.save(os.path.join(save_base_path,&nbsp;row.img_name))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff3399">except</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image_error_id_lst.append(row.url_path)</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4be6fa">print</span>(f<span style="color:#ffd500">"no&nbsp;save&nbsp;image&nbsp;:&nbsp;{row.url_path}"</span>)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#4f4f4f;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
    <br>
    train batch 샘플 (간판 데이터)<br>
    <img src="/assets/img/experience/trainbatch1.jpg"><br></center><br><br>
    <h3>🎉 결과 및 성과</h3>
    <img src="/assets/img/experience/trainplot.png"><br></center>
    <img src="/assets/img/experience/preds1.png"><br></center>
    <br><br>
      <ul>
        <li> 각 사업 목표 mAP 0.6 초과 달성 (초기 mAP 0.2 ~ 0.3)</li>
        <li> 극단적 데이터 불균형 상황에서의 모델링 어려움 및 데이터 품질의 중요성을 절실히 느낌</li>
        <li> AI Hub 업로드 산출물 <a href="https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=71298">링크</a>(간판데이터)</li>
        <br>
      </ul>
    </ul>
